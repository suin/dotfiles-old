# source $HOME/.zsh/main.zsh

: "Options" && {
  autoload -U compinit && compinit # è£œå®Œæ©Ÿèƒ½ã®å¼·åŒ–
  setopt correct # å…¥åŠ›ã—ã¦ã„ã‚‹ã‚³ãƒãƒ³ãƒ‰åãŒé–“é•ã£ã¦ã„ã‚‹å ´åˆã«ã‚‚ã—ã‹ã—ã¦ï¼šã‚’å‡ºã™ã€‚
  setopt nobeep # ãƒ“ãƒ¼ãƒ—ã‚’é³´ã‚‰ã•ãªã„
  setopt prompt_subst # è‰²ã‚’ä½¿ã†
  setopt ignoreeof # ^Dã§ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ãªã„ã€‚
  setopt no_tify # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¸ãƒ§ãƒ–ãŒçµ‚äº†ã—ãŸã‚‰ã™ãã«çŸ¥ã‚‰ã›ã‚‹ã€‚
  setopt hist_ignore_dups # ç›´å‰ã¨åŒã˜ã‚³ãƒãƒ³ãƒ‰ã‚’ãƒ’ã‚¹ãƒˆãƒªã«è¿½åŠ ã—ãªã„
  unsetopt auto_menu # ã‚¿ãƒ–ã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®é †ç•ªåˆ‡ã‚Šæ›¿ãˆã‚’ã—ãªã„
  setopt auto_pushd # cd -[tab]ã§éå»ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã²ã¨ã£é£›ã³ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
  setopt auto_cd # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§cdã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
}

: "Prompt" && {
  autoload -U promptinit && promptinit
  autoload -Uz colors && colors
  autoload -Uz vcs_info
  autoload -Uz is-at-least

  : "Showing VCS status at propt" && {
    zstyle ":vcs_info:*" enable git svn hg bzr
    zstyle ":vcs_info:*" formats "(%s)-[%b]"
    zstyle ":vcs_info:*" actionformats "(%s)-[%b|%a]"
    zstyle ":vcs_info:(svn|bzr):*" branchformat "%b:r%r"
    zstyle ":vcs_info:bzr:*" use-simple true

    zstyle ":vcs_info:*" max-exports 6

    if is-at-least 4.3.10; then
      zstyle ":vcs_info:git:*" check-for-changes true # commitã—ã¦ã„ãªã„ã®ã‚’ãƒã‚§ãƒƒã‚¯
      zstyle ":vcs_info:git:*" stagedstr "<S>"
      zstyle ":vcs_info:git:*" unstagedstr "<U>"
      zstyle ":vcs_info:git:*" formats "(%b) %c%u"
      zstyle ":vcs_info:git:*" actionformats "(%s)-[%b|%a] %c%u"
    fi

    function vcs_prompt_info() {
      LANG=en_US.UTF-8 vcs_info
      [[ -n "$vcs_info_msg_0_" ]] && echo -n " %{$fg[yellow]%}$vcs_info_msg_0_%f"
    }
  }

  : "Prompt format settings" && {
    OK="ğŸ€ "
    NG="ğŸ”¥ "
    PROMPT=""
    PROMPT+="%(?.%F{green}$OK%f.%F{red}$NG%f) "
    PROMPT+="%F{blue}%~%f"
    PROMPT+="\$(vcs_prompt_info)"
    PROMPT+=$'\n'
    PROMPT+="\$ "
  }
}

: "Aliases" && {
  alias ls="ls -G" # color for darwin
  alias l="ls -la"
  alias la="ls -la"
  alias l1="ls -1"
  alias tree="tree -NC" # N: æ–‡å­—åŒ–ã‘å¯¾ç­–, C:è‰²ã‚’ã¤ã‘ã‚‹
  alias cot="open -a CotEditor"
}

: "Key bindings" && {
  bindkey -e # emacs ã‚­ãƒ¼ãƒãƒƒãƒ—ã‚’é¸æŠ
  function dig-directory() { cd .. && zle reset-prompt }
  zle -N dig-directory
  bindkey '^K' dig-directory # Ctrl-Kã§ä¸Šã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¸ŠãŒã‚‹
  bindkey "^R" history-incremental-search-backward
}

: "External configs" && {
  [ -f /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ] && source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
}

: "Misc" && {
  function chpwd() { tree -L 1 } # cdã—ãŸã‚ã¨ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹
}
